<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
  <meta charset="utf-8">

  <title>患者信息录入</title>

  <!-- Include order: first jquery, then opencpu.js, and then your code -->
  <script src="jquery-1.10.2.min.js"></script>
  <script src="opencpu-0.4.js"></script>
  <script>
  <!--
    function isNumber(value) {
      //验证是否为数字
      var patrn = /^(-)?\d+(\.\d+)?$/;
      if (patrn.exec(value) == null || value == "") {
        return false
      } else {
        return true
      }
    };

    //init this script when the page has loaded
    $(document).ready(function(){
      $("#resetbutton").on("click", function(){
        $("#submitbutton").removeAttr("disabled");
        $("#output").css('display','none');
        $("#output").text('');
      });
      $("#submitbutton").on("click", function(){
        //disable the button to prevent multiple clicks
        $("#submitbutton").attr("disabled", "disabled");
        $("#output").css('display','none');
        if (isNumber($('#f6').val()) && isNumber($("#f11").val()) && isNumber($("#f12").val()) && isNumber($("#f13").val())){
          //read the value for 'myname'
          //var myname = $("#f1").val();
          var input1 = { input : [{
            "f1" : $("#f1").val(),
            "f2" : $("#f2").val(),
            "f3" : $("#f3").val(),
            "f4" : $("#f4").val(),
            "f5" : $("#f5").val(),
            "f6" : $("#f6").val(),
            "f7" : $("#f7").val(),
            "f8" : $("#f8").val(),
            "f9" : $("#f9").val(),
            "f10" : $("#f10").val(),
            "f11" : $("#f11").val(),
            "f12" : $("#f12").val(),
            "f13" : $("#f13").val()
          }] }
          console.log(input1)
          //perform the request
          var req = ocpu.rpc("cmccmpredfunc", input1 , function(output){
            alert(output)
            $("#output").css('display','inline');
            $("#output").text(output);
          });

          //if R returns an error, alert the error message
          req.fail(function(){
            alert("Server error: " + req.responseText);
          });

          //after request complete, re-enable the button
          req.always(function(){
            $("#submitbutton").removeAttr("disabled")
          });
        } else {
          $("#submitbutton").removeAttr("disabled");
          $("#output").css('display','none');
          alert("请输入所有信息！！")
        }
      });
    });
    -->
    </script>

  <style>
      #output{
        height: 80px;
        width: 500px;
        border: 1px solid gray;
        padding: 3px;
      }
    </style>

</head>

<body>
<div align="center">
  <table>
    <tr><td align="center" colspan="2"><h2>患者信息录入</h2></td></tr>
    <tr>
      <td align="right">肿瘤原发部位</td>
      <td align="left"><select id="f1"><option value="1">左半肠</option><option value="0">右半肠</option></select></td>
    </tr>
    <tr>
      <td align="right">基因_RAS</td>
      <td align="left"><select id="f2"><option value="1">KRAS/NRAS突变</option><option value="0">无</option></select></td>
    </tr>
    <tr>
      <td align="right">基因_BRAF</td>
      <td align="left"><select id="f3"><option value="1">BRAF突变</option><option value="0">无</option></select></td>
    </tr>
    <tr>
      <td align="right">肝转移</td>
      <td align="left"><select id="f4"><option value="1">有</option><option value="0">没有</option></select></td>
    </tr>
    <tr>
      <td align="right">肺转移</td>
      <td align="left"><select id="f5"><option value="1">有</option><option value="0">没有</option></select></td>
    </tr>
    <tr>
      <td align="right">KPS评分</td>
      <td align="left"><input id="f6" type="text" value=""></td>
    </tr>
    <tr>
      <td align="right">中医证型：肝虚</td>
      <td align="left"><select id="f7"><option value="1">是</option><option value="0">否</option></select></td>
    </tr>
    <tr>
      <td align="right">中医证型：肺虚</td>
      <td align="left"><select id="f8"><option value="1">是</option><option value="0">否</option></select></td>
    </tr>
    <tr>
      <td align="right">中医证型：肾虚</td>
      <td align="left"><select id="f9"><option value="1">是</option><option value="0">否</option></select></td>
    </tr>
    <tr>
      <td align="right">中医证型：脾虚</td>
      <td align="left"><select id="f10"><option value="1">是</option><option value="0">否</option></select></td>
    </tr>
    <tr>
      <td align="right">中医临床症状评分总分值</td>
      <td align="left"><input id="f11" type="text" value=""></td>
    </tr>
    <tr>
      <td align="right">近3个月主症评分总分</td>
      <td align="left"><input id="f12" type="text" value=""></td>
    </tr>
    <tr>
      <td align="right">症状妨碍生活评分总分</td>
      <td align="left"><input id="f13" type="text" value=""></td>
    </tr>
    <tr><td align="center" colspan="2">
      <button id="submitbutton" type="button">确定</button>
      <button id="resetbutton" type="button">重置</button>
    </td></tr>
    <tr><td align="center" colspan="2"><div style="display:none" id="output" align="center"></div></td></tr>
  </table>

</div>



</body>
</html>
